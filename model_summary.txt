# Model Summary

This document provides a summary of the Django models used in the splitcart project, outlining their purpose and relationships.

## `companies` App Models

### `Company`
- **Purpose:** Represents a parent company or brand that owns one or more stores (e.g., 'IGA', 'Coles Group').
- **Fields:**
    - `name`: The unique name of the company.
- **Relationships:**
    - Has a one-to-many relationship with `Division`, `Store`, and `Category`.

### `Division`
- **Purpose:** Represents a specific division or banner under a parent company (e.g., 'Woolworths Metro' is a division under 'Woolworths').
- **Fields:**
    - `name`: The name of the division.
    - `company`: A foreign key to the `Company` model.
- **Relationships:**
    - Belongs to one `Company`.
    - Has a one-to-many relationship with `Store`.

### `Store`
- **Purpose:** Represents a physical or virtual store where products are sold.
- **Fields:**
    - `store_name`: The name of the store.
    - `company`: A foreign key to the `Company` model.
    - `division`: A nullable foreign key to the `Division` model.
    - `store_id`: The unique identifier for the store from the company's own system.
    - Various address and location fields.
- **Relationships:**
    - Belongs to one `Company` and optionally one `Division`.
    - Has a one-to-many relationship with `Price`.

### `Category`
- **Purpose:** Represents a product category within a specific company's hierarchy.
- **Fields:**
    - `name`: The name of the category.
    - `slug`: A URL-friendly version of the name.
    - `company`: A foreign key to the `Company` model.
    - `parents`: A many-to-many relationship to itself, allowing for a nested category structure.
- **Relationships:**
    - Belongs to one `Company`.
    - Has a many-to-many relationship with `Product`.

## `products` App Models

### `Product`
- **Purpose:** Represents a master product, independent of any single store.
- **Fields:**
    - `name`: The name of the product.
    - `brand`: The product's brand.
    - `barcode`: The universal barcode (UPC/EAN) of the product.
    - `normalized_name_brand_size`: A normalized string for identifying unique products.
- **Relationships:**
    - Has a many-to-many relationship with `Category`.
    - Has a one-to-many relationship with `Price`.
    - Has self-referential many-to-many relationships for `substitute_goods` and `size_variants`.

### `Price`
- **Purpose:** Represents the price of a product at a specific store on a specific date.
- **Fields:**
    - `product`: A foreign key to the `Product` model.
    - `store`: A foreign key to the `Store` model.
    - `price`: The price of the product.
    - `scraped_at`: The date and time the price was recorded.
- **Relationships:**
    - Belongs to one `Product` and one `Store`.

## Inter-App Relationships

- `products.Price` is linked to `companies.Store`.
- `products.Product` is linked to `companies.Category`.

This structure allows for a clear separation of concerns, with the `companies` app managing the stores and their hierarchy, and the `products` app managing the products and their prices across those stores.

## Potential Improvements
### `Product` Model
- **Problem:** The `has_no_coles_barcode` field is not scalable. If we need to track barcode availability for other companies, we would have to add more boolean fields.
- **Suggestion:** A better approach would be to create a separate model, `ProductBarcodeAvailability`, with a foreign key to `Product` and `Company`. This model could have a boolean field `has_barcode` to indicate whether a barcode is available for that product at that company. This would be a more flexible and scalable solution.
- **Problem:** The `name_variations` and `normalized_name_brand_size_variations` are stored as `JSONField`. This is good for flexibility, but it can be difficult to query efficiently.
- **Suggestion:** If there is a need for frequent querying of these variations, it would be better to move them to a separate `ProductVariation` model with a foreign key to the `Product` model. This would allow for easier querying and indexing of variations.

### Address Fields in `Store` Model
- **Problem:** The `Store` model has several address-related fields (`address_line_1`, `address_line_2`, `suburb`, `state`, `postcode`).
- **Suggestion:** For better organization and potential reuse, these fields could be encapsulated into a separate `Address` model. The `Store` model would then have a foreign key to the `Address` model. However, given the current scope of the project, the existing structure might be sufficient and this change might be an over-optimization.