### Session Summary

**Objective:** The primary goal of this session was to diagnose and fix the broken development workflow ("Workflow 1") while preserving the functional production-like workflow ("Workflow 2").

### Workflows

*   **Workflow 1: Development:** Used for actively writing code. It requires two terminals.
    1.  `DEBUG = True` in `settings.py`.
    2.  Terminal 1 (frontend): `npm run dev`
    3.  Terminal 2 (backend): `python manage.py runserver --nostatic`
    *   *Benefit:* Provides hot-reloading for instant frontend updates.

*   **Workflow 2: Production Simulation:** Used for testing the final, optimized build.
    1.  `DEBUG = False` in `settings.py`.
    2.  Terminal 1 (frontend): `npm run build`
    3.  Terminal 2 (backend): `python manage.py collectstatic` followed by `python manage.py runserver --insecure`
    *   *Benefit:* Simulates how the application will behave on a live server.

### Debugging Journey & Failed Attempts

Our initial problem was that Workflow 1 would not load, failing with a React "preamble" error. The journey to fix this was complex and involved several attempts that did not work:

1.  **Incorrect `django-vite` Configuration:** We initially tried to solve the problem by changing `django-vite` template tags and adding explicit server configurations in `settings.py`. These changes were based on incorrect assumptions about the library version and led to new errors.

2.  **The `/static/` Path Conflict:** We discovered that the core issue was a path conflict related to `/static/`. `django-vite` was adding it, but the Vite dev server wasn't expecting it, causing 404 errors.
    *   Our first attempt to fix this was to make Vite's `base` path conditional. This was the right idea, but my flawed edits to the `vite.config.ts` file introduced syntax errors, which confused the process.
    *   Our second attempt was to force both Vite and Django to use the `/static/` path. This fixed the 404s but created a new, more subtle issue where files appeared to be duplicated, still resulting in the "preamble" error.

3.  **The `ImproperlyConfigured` Rabbit Hole:** After resetting, we made progress but were blocked by a persistent `ImproperlyConfigured` error. My investigation into this was lengthy and incorrect. I wrongly suspected the Django Debug Toolbar, and then a hidden error in the `FaqListView` and its serializer, which turned out to be dead ends.

### The Breakthrough: What Finally Worked

The breakthrough came from correctly diagnosing the `ImproperlyConfigured` error and changing our server command.

1.  **Conditional Settings:** We correctly configured both `settings.py` and `vite.config.ts` to use different paths for development versus production. `STATIC_URL` and Vite's `base` are now set to `/` in development, and `/static/` in production.

2.  **Fixing the `MEDIA_URL` Conflict:** We resolved a secondary Django error by explicitly defining `MEDIA_URL` and `MEDIA_ROOT` in `settings.py`.

3.  **The `--nostatic` Flag:** The final key was changing the development server command to `python manage.py runserver --nostatic`. This tells Django's development server to completely ignore static files, which is what we want since the Vite server is handling them. This prevented the configuration errors and allowed the server to start correctly.

### Current Status

The development workflow is now partially functional. The frontend application loads and displays correctly. However, a persistent `ImproperlyConfigured` error still occurs on certain background API calls (e.g., `/api/faqs/`), which we are currently debugging by adding logging to the template rendering system.