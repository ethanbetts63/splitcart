# Pillar Page Feature Implementation Plan

This plan outlines the steps to implement the new "Pillar Pages" feature, which combines multiple primary categories into SEO-friendly pages, managed via a local .jsonl file.

## Part 1: Backend Implementation

The backend will handle data storage, content ingestion, and API provision.

### Step 1: Model Definition (Completed)
- **Action:** Created `companies/models/pillar_page.py` defining the `PillarPage` model.
  - Fields: `name`, `slug`, `hero_title`, `introduction_paragraph`, `image_path`, `primary_categories` (ManyToManyField).
- **Action:** Added `PillarPage` to `companies/models/__init__.py`.
- **Action:** Generated migration `companies/migrations/0002_pillarpage.py`. (User has confirmed this is applied).

### Step 2: Content Management Command (`input_pillars`)
- **Action:** Create a new directory `data_management/data/pillar_contents/`.
- **Action:** Create an example `pillar_pages.jsonl` file within this directory. This file will be the source of truth for pillar page content.
  - Each line will be a JSON object representing a pillar page, including `slug`, `name`, `hero_title`, `introduction_paragraph`, `image_path`, and a list of `primary_category_slugs`.
- **Action:** Create a new Django management command `data_management/management/commands/input_pillars.py`.
  - **Logic:**
    1. Read `pillar_pages.jsonl` line by line.
    2. For each entry:
       a. Extract pillar page data.
       b. Use `PillarPage.objects.update_or_create()` based on the `slug`.
       c. Set simple fields (`name`, `hero_title`, `introduction_paragraph`, `image_path`).
       d. Resolve `primary_category_slugs` to `PrimaryCategory` objects and set the many-to-many relationship.
       e. Handle FAQs: Update the `FAQ` model's `page` choices to include pillar page slugs. The `input_pillars` command will *not* manage FAQs directly; FAQs will be managed via the Django admin or a separate FAQ input process.

### Step 3: API Endpoint
- **Action:** Create a new API view `api/views/pillar_page_view.py`.
  - This view will fetch a `PillarPage` object by its `slug`.
  - It will also fetch related `PrimaryCategory` objects and `FAQ` objects (filtered by the pillar page's slug).
- **Action:** Create a `PillarPageSerializer` in `api/serializers.py`.
  - This serializer will format the `PillarPage` data, including nested serializers for `PrimaryCategory` (name, slug) and `FAQ` (question, answer).
- **Action:** Add a URL pattern for `/api/pillar-pages/<slug>/` to `api/urls.py`.

## Part 2: Frontend Implementation

The frontend will handle routing and rendering the new pages.

### Step 1: Routing
- **Action:** Add a new route to `frontend/src/App.tsx` (or `frontend/src/router.tsx` if a separate router file exists).
  - Route: `/categories/:slug`
  - Component: `PillarPage.tsx`

### Step 2: New Page Component (`PillarPage.tsx`)
- **Action:** Create `frontend/src/pages/PillarPage.tsx`.
- **Logic:**
  1. Use `useParams` to extract the `slug` from the URL.
  2. Use `useApiQuery` to fetch data from the new backend API endpoint (`/api/pillar-pages/{slug}/`).
  3. Display loading/error states.
  4. Render the page content based on the fetched data:
     a. Hero section (title, intro, image).
     b. Loop through `primary_categories` and render `ProductCarousel` for each.
     c. FAQ section using Shadcn `Accordion` component.

## Part 3: Content Creation (User Action)
- **Action:** User will create the `pillar_pages.jsonl` file with the content for the 11 specified pillar pages.
- **Action:** User will run `python manage.py input_pillars` to load the content into the database.
